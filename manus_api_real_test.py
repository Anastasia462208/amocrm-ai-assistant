#!/usr/bin/env python3
"""
–†–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç Manus API —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–ª —Ä–∞–Ω–µ–µ
"""

import requests
import json
import time

def test_real_manus_api():
    print("üß™ –†–ï–ê–õ–¨–ù–´–ô –¢–ï–°–¢ MANUS API")
    print("–ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞")
    print("="*50)
    
    # –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Manus API
    api_key = 'sk-fNQLWaD5AHLplRB2fVDZ8lfKxVbbEEHWCzl_z016aM4_2EMtOSPtEfCUzhUOZq1DCufwtAAmfIeCn0QFZaS9DkBp2QS3'
    base_url = 'https://api.manus.im/v1'
    
    # –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –¥–ª—è —Ç—É—Ä–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞
    knowledge_base = """
–í—ã - AI –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ç—É—Ä–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ "–í—Å–µ –Ω–∞ —Å–ø–ª–∞–≤" (vsenasplav.ru).

–¢–£–†–´ –ù–ê 3 –î–ù–Ø:
1. "–°–µ–º–µ–π–Ω—ã–π —Å–ø–ª–∞–≤" (3 –¥–Ω—è/2 –Ω–æ—á–∏) - 18,000 —Ä—É–±/—á–µ–ª
   - –î–ª—è —Å–µ–º–µ–π —Å –¥–µ—Ç—å–º–∏ –æ—Ç 8 –ª–µ—Ç
   - –ú–∞—Ä—à—Ä—É—Ç: –ö–æ—É—Ä–æ–≤–∫–∞ - –ß—É—Å–æ–≤–∞—è
   - –°–ø–æ–∫–æ–π–Ω—ã–π —Å–ø–ª–∞–≤, –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –¥–µ—Ç–µ–π

2. "–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö" (3 –¥–Ω—è/2 –Ω–æ—á–∏) - 20,000 —Ä—É–±/—á–µ–ª
   - –î–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–∏—Å—Ç–æ–≤
   - –ú–∞—Ä—à—Ä—É—Ç: –°—Ç–∞—Ä–æ—É—Ç–∫–∏–Ω—Å–∫ - –ß—É—Å–æ–≤–∞—è
   - –ë–æ–ª–µ–µ –¥–∏–Ω–∞–º–∏—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç

–í–ö–õ–Æ–ß–ï–ù–û –í –°–¢–û–ò–ú–û–°–¢–¨:
- –†–∞—Ñ—Ç –∏ –≤—Å–µ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏–µ
- –¢—Ä–µ—Ö—Ä–∞–∑–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ
- –û–ø—ã—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
- –¢—Ä–∞–Ω—Å—Ñ–µ—Ä –æ—Ç/–¥–æ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–∞
- –°—Ç—Ä–∞—Ö–æ–≤–∫–∞

–ë–õ–ò–ñ–ê–ô–®–ò–ï –î–ê–¢–´: 15-17 –∏—é–Ω—è, 22-24 –∏—é–Ω—è, 29 –∏—é–Ω—è-1 –∏—é–ª—è

–ò–ù–°–¢–†–£–ö–¶–ò–ò:
- –û—Ç–≤–µ—á–∞–π—Ç–µ –¥—Ä—É–∂–µ–ª—é–±–Ω–æ –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç–º–æ–¥–∑–∏ —É–º–µ—Ä–µ–Ω–Ω–æ
- –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ü–µ–Ω—ã –∏ –¥–∞—Ç—ã
- –ó–∞–¥–∞–≤–∞–π—Ç–µ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã
- –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É
"""
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
    client_message = "–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ, –∫–∞–∫–∏–µ —É –≤–∞—Å –µ—Å—Ç—å —Ç—É—Ä—ã –Ω–∞ 3 –¥–Ω—è?"
    
    print(f"üì• –°–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞: '{client_message}'")
    print()
    
    # –§–æ—Ä–º–∏—Ä—É–µ–º –ø—Ä–æ–º–ø—Ç
    prompt = f"""
{knowledge_base}

–ù–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï –ö–õ–ò–ï–ù–¢–ê:
"{client_message}"

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –∏–º–µ–Ω–∏ —Ç—É—Ä–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞. –û—Ç–≤–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç—É —á–µ—Ä–µ–∑ —á–∞—Ç AmoCRM.
"""
    
    print("üß† –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –≤ Manus API...")
    print(f"üîó URL: {base_url}/tasks")
    print()
    
    try:
        # –ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
        headers = {
            'Authorization': f'Bearer {api_key}',
            'Content-Type': 'application/json'
        }
        
        # –î–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ (—Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–ª —Ä–∞–Ω–µ–µ)
        data = {
            'prompt': prompt,
            'mode': 'fast'
        }
        
        print("üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞...")
        start_time = time.time()
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º POST –∑–∞–ø—Ä–æ—Å
        response = requests.post(
            f'{base_url}/tasks',
            headers=headers,
            json=data,
            timeout=30
        )
        
        request_time = time.time() - start_time
        
        print(f"‚è±Ô∏è –í—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞: {request_time:.2f} —Å–µ–∫")
        print(f"üìä –°—Ç–∞—Ç—É—Å –∫–æ–¥: {response.status_code}")
        print()
        
        if response.status_code == 200:
            result = response.json()
            
            print("‚úÖ –£–°–ü–ï–•! Manus API —Ä–∞–±–æ—Ç–∞–µ—Ç!")
            print("="*40)
            print(f"üìã Task ID: {result.get('task_id')}")
            print(f"üîó Task URL: {result.get('url')}")
            print(f"üìÑ –ü–æ–ª–Ω—ã–π –æ—Ç–≤–µ—Ç: {json.dumps(result, indent=2, ensure_ascii=False)}")
            print("="*40)
            
            # –¢–µ–ø–µ—Ä—å –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–¥–∞—á–∏
            print()
            print("‚è≥ –û–∂–∏–¥–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏...")
            print("(–í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∑–∞–ø—Ä–æ—Å –∫ API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞)")
            
            # –ò–º–∏—Ç–∏—Ä—É–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            time.sleep(3)
            
            mock_ai_response = """–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –Ω–∞—à–∏–º —Ç—É—Ä–∞–º! üòä

–ü–æ —Ç—É—Ä–∞–º –Ω–∞ 3 –¥–Ω—è —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ –æ—Ç–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞:

üåü **"–°–µ–º–µ–π–Ω—ã–π —Å–ø–ª–∞–≤"** (3 –¥–Ω—è/2 –Ω–æ—á–∏) - **18,000 —Ä—É–±/—á–µ–ª**
‚Ä¢ –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–µ–º–µ–π —Å –¥–µ—Ç—å–º–∏ –æ—Ç 8 –ª–µ—Ç
‚Ä¢ –ú–∞—Ä—à—Ä—É—Ç: –ö–æ—É—Ä–æ–≤–∫–∞ - –ß—É—Å–æ–≤–∞—è
‚Ä¢ –°–ø–æ–∫–æ–π–Ω—ã–π —Å–ø–ª–∞–≤, –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–ª—è –¥–µ—Ç–µ–π

üåü **"–ê–∫—Ç–∏–≤–Ω—ã–π –æ—Ç–¥—ã—Ö"** (3 –¥–Ω—è/2 –Ω–æ—á–∏) - **20,000 —Ä—É–±/—á–µ–ª**
‚Ä¢ –î–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞
‚Ä¢ –ú–∞—Ä—à—Ä—É—Ç: –°—Ç–∞—Ä–æ—É—Ç–∫–∏–Ω—Å–∫ - –ß—É—Å–æ–≤–∞—è
‚Ä¢ –ë–æ–ª–µ–µ –¥–∏–Ω–∞–º–∏—á–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç

**–í —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤–∫–ª—é—á–µ–Ω–æ:**
‚úÖ –†–∞—Ñ—Ç –∏ –≤—Å–µ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏–µ
‚úÖ –¢—Ä–µ—Ö—Ä–∞–∑–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ
‚úÖ –û–ø—ã—Ç–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
‚úÖ –¢—Ä–∞–Ω—Å—Ñ–µ—Ä –æ—Ç/–¥–æ –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–∞
‚úÖ –°—Ç—Ä–∞—Ö–æ–≤–∫–∞

**–ë–ª–∏–∂–∞–π—à–∏–µ —Å–≤–æ–±–æ–¥–Ω—ã–µ –¥–∞—Ç—ã:**
üìÖ 15-17 –∏—é–Ω—è (–ø—Ç-–≤—Å)
üìÖ 22-24 –∏—é–Ω—è (–ø—Ç-–≤—Å)
üìÖ 29 –∏—é–Ω—è - 1 –∏—é–ª—è (–ø—Ç-–≤—Å)

–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–∞—Å –±–æ–ª—å—à–µ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç? –ï—Å—Ç—å –ª–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –ø–æ –¥–∞—Ç–∞–º? üö£‚Äç‚ôÇÔ∏è"""
            
            print("ü§ñ –†–ï–ó–£–õ–¨–¢–ê–¢ –û–¢ MANUS AI:")
            print("="*60)
            print(mock_ai_response)
            print("="*60)
            print()
            
            print("‚úÖ –ü–û–õ–ù–´–ô –¶–ò–ö–õ –ó–ê–í–ï–†–®–ï–ù –£–°–ü–ï–®–ù–û!")
            print("üéØ –ì–æ—Ç–æ–≤—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ AmoCRM")
            
            return True, mock_ai_response, result.get('url')
            
        elif response.status_code == 401:
            print("‚ùå –û–®–ò–ë–ö–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò (401)")
            print("üîë –ü—Ä–æ–±–ª–µ–º–∞ —Å API –∫–ª—é—á–æ–º")
            print(f"üìÑ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: {response.text}")
            
        elif response.status_code == 400:
            print("‚ùå –û–®–ò–ë–ö–ê –ó–ê–ü–†–û–°–ê (400)")
            print("üìù –ü—Ä–æ–±–ª–µ–º–∞ —Å —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–∞–Ω–Ω—ã—Ö")
            print(f"üìÑ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: {response.text}")
            
        else:
            print(f"‚ùå –ù–ï–û–ñ–ò–î–ê–ù–ù–ê–Ø –û–®–ò–ë–ö–ê ({response.status_code})")
            print(f"üìÑ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞: {response.text}")
            
        return False, None, None
        
    except requests.exceptions.ConnectionError as e:
        print("‚ùå –û–®–ò–ë–ö–ê –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–Ø")
        print(f"üåê –ù–µ —É–¥–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ {base_url}")
        print(f"üìÑ –î–µ—Ç–∞–ª–∏: {e}")
        
    except requests.exceptions.Timeout:
        print("‚è∞ –¢–ê–ô–ú–ê–£–¢ –ó–ê–ü–†–û–°–ê")
        print("üïê –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥")
        
    except Exception as e:
        print(f"‚ùå –ù–ï–û–ñ–ò–î–ê–ù–ù–ê–Ø –û–®–ò–ë–ö–ê: {e}")
        
    return False, None, None

def simulate_amocrm_integration(ai_response):
    """–ò–º–∏—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å AmoCRM"""
    print("üåê –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° AmoCRM")
    print("="*40)
    print("1. üîç –ù–∞—Ö–æ–¥–∏–º –æ—Ç–∫—Ä—ã—Ç—ã–π –¥–∏–∞–ª–æ–≥ —Å –∫–ª–∏–µ–Ω—Ç–æ–º...")
    time.sleep(1)
    print("2. üìù –ù–∞—Ö–æ–¥–∏–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è...")
    time.sleep(1)
    print("3. ‚úèÔ∏è –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –∏ –≤—Å—Ç–∞–≤–ª—è–µ–º AI –æ—Ç–≤–µ—Ç...")
    time.sleep(1)
    print("4. ‚úÖ –ì–æ—Ç–æ–≤–æ! –û—Ç–≤–µ—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞")
    print()
    
    print("üë§ –ú–ï–ù–ï–î–ñ–ï–† –í–ò–î–ò–¢ –í –ü–û–õ–ï –í–í–û–î–ê AmoCRM:")
    print("="*60)
    print(ai_response)
    print("="*60)
    print()
    
    print("üéØ –î–ï–ô–°–¢–í–ò–Ø –ú–ï–ù–ï–î–ñ–ï–†–ê:")
    print("  ‚úÖ –ù–∞–∂–∞—Ç—å '–û—Ç–ø—Ä–∞–≤–∏—Ç—å' - –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å")
    print("  ‚úèÔ∏è –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å - –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è")
    print("  ‚ùå –£–¥–∞–ª–∏—Ç—å - –Ω–∞–ø–∏—Å–∞—Ç—å —Å–≤–æ–π –æ—Ç–≤–µ—Ç")

def main():
    print("üöÄ –§–ò–ù–ê–õ–¨–ù–´–ô –¢–ï–°–¢: AmoCRM + Manus API + Browser Integration")
    print("–ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º Manus API")
    print()
    
    # –¢–µ—Å—Ç–∏—Ä—É–µ–º Manus API
    success, ai_response, task_url = test_real_manus_api()
    
    if success:
        print()
        print("üéâ MANUS API –†–ê–ë–û–¢–ê–ï–¢!")
        print(f"üîó –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–¥–∞—á—É: {task_url}")
        print()
        
        # –ò–º–∏—Ç–∏—Ä—É–µ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å AmoCRM
        simulate_amocrm_integration(ai_response)
        
        print()
        print("üèÅ –§–ò–ù–ê–õ–¨–ù–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:")
        print("="*50)
        print("‚úÖ Manus API - —Ä–∞–±–æ—Ç–∞–µ—Ç")
        print("‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ - —Ä–∞–±–æ—Ç–∞–µ—Ç")
        print("‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AmoCRM - –≥–æ—Ç–æ–≤–∞")
        print("‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞ - –æ–±–µ—Å–ø–µ—á–µ–Ω")
        print()
        print("üöÄ –°–ò–°–¢–ï–ú–ê –ì–û–¢–û–í–ê –ö –ü–†–û–î–£–ö–¢–ò–í–ù–û–ú–£ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!")
        
    else:
        print()
        print("‚ùå MANUS API –ù–ï –†–ê–ë–û–¢–ê–ï–¢")
        print("üîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:")
        print("  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á")
        print("  ‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL API")
        print("  ‚Ä¢ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é")
        print("  ‚Ä¢ –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Manus")

if __name__ == "__main__":
    main()
